<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="SmartGrocery.App.Views.ListLayouts.CheckListTemplate"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Name="CheckListView">
    <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="0">
        
        <!-- Top bar with search and clear completed -->
        <Grid Grid.Row="0" RowDefinitions="Auto,Auto" RowSpacing="8" Padding="16,16,16,8">
            <!-- Search bar -->
            <Frame
                Grid.Row="0"
                Padding="4"
                BackgroundColor="#2D2D2D"
                BorderColor="Transparent"
                CornerRadius="12"
                HasShadow="False"
                IsVisible="{Binding HasItems}">
                <Entry
                    ClearButtonVisibility="WhileEditing"
                    Placeholder="Search items..."
                    PlaceholderColor="#B0B0B0"
                    Text="{Binding SearchQuery}"
                    TextColor="White"
                    BackgroundColor="Transparent" />
            </Frame>
            
            <!-- Clear completed button -->
            <Button
                Grid.Row="1"
                Text="Clear Completed"
                FontSize="14"
                BackgroundColor="Transparent"
                TextColor="#B0B0B0"
                Command="{Binding ClearCheckedCommand}"
                HorizontalOptions="End"
                IsVisible="{Binding HasCheckedItems}" />
        </Grid>
        
        <!-- Empty state -->
        <VerticalStackLayout
            Grid.Row="2"
            Spacing="16"
            HorizontalOptions="Center"
            VerticalOptions="Center"
            IsVisible="{Binding HasItems, Converter={StaticResource InverseBoolConverter}}">
            <Label
                Text="ðŸ›’"
                FontSize="72"
                HorizontalTextAlignment="Center" />
            <Label
                Text="Your list is empty"
                FontSize="20"
                FontAttributes="Bold"
                HorizontalTextAlignment="Center"
                TextColor="White" />
            <Label
                Text="Tap the + button below to add your first item"
                FontSize="14"
                HorizontalTextAlignment="Center"
                TextColor="#B0B0B0" />
        </VerticalStackLayout>
        
        <!-- Items list -->
        <CollectionView
            Grid.Row="2"
            ItemsSource="{Binding Items}"
            SelectionMode="None">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12" Padding="16,12">
                        <!-- Checkbox -->
                        <CheckBox
                            Grid.Column="0"
                            CheckedChanged="OnCheckedChanged"
                            IsChecked="{Binding IsChecked}"
                            Color="Gray"
                            VerticalOptions="Center" />
                        
                        <!-- Item name -->
                        <Label
                            Grid.Column="1"
                            FontSize="16"
                            Text="{Binding ItemName}"
                            TextColor="White"
                            VerticalOptions="Center">
                            <Label.Triggers>
                                <DataTrigger
                                    Binding="{Binding IsChecked}"
                                    TargetType="Label"
                                    Value="True">
                                    <Setter Property="TextDecorations" Value="Strikethrough" />
                                    <Setter Property="TextColor" Value="#4A4A4A" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                        
                        <!-- Delete button -->
                        <ImageButton
                            Grid.Column="2"
                            Padding="8"
                            Aspect="AspectFit"
                            BackgroundColor="Transparent"
                            Command="{Binding BindingContext.DeleteItemCommand, Source={x:Reference Name=CheckListView}}"
                            CommandParameter="{Binding .}"
                            HeightRequest="32"
                            Source="trash_can.svg"
                            VerticalOptions="Center"
                            WidthRequest="32" />
                        
                        <!-- Separator line -->
                        <BoxView
                            Grid.ColumnSpan="3"
                            HeightRequest="1"
                            Color="#3A3A3A"
                            VerticalOptions="End"
                            HorizontalOptions="Fill" />
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        
        <!-- FAB for adding items -->
        <Button
            Grid.Row="3"
            Margin="0,0,20,20"
            Command="{Binding AddItemCommand}"
            CornerRadius="12"
            HeightRequest="56"
            WidthRequest="56"
            Padding="0"
            BackgroundColor="#7C3AED"
            FontSize="32"
            Text="+"
            TextColor="White"
            Shadow="{Shadow Brush=#9D4EDD, Offset='0,2', Radius=12, Opacity=0.6}"
            VerticalOptions="Center"
            HorizontalOptions="End" />
        
    </Grid>
</ContentView>